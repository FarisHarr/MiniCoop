<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/JSP_Servlet/Html.html to edit this template
-->
<html>
    <head>
        <title>Product Page</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="ProductPage.css">
    </head>
    <body>
        <header>
            <div class="main">
                <img class="logo" src="logoRe.png" alt="logo">
                <nav>
                    <ul class="nav_links">
                        <li><a href="homePage.html">Home</a></li>
                        <li><a href="ProductPage.html">Product</a></li>
                        <li><a href="ManageContactUs.html">Contact Us</a></li>
                    </ul>
                </nav>
            </div>
            <nav>
                <li class="dropdown">
                    <a class="nav-link">Account</a>
                    <ul class="dropdown-content">
                        <li><a href="CustomerProfile.html">Edit Information</a></li>
                        <li><a href="StartPage.html">Sign Out</a></li>
                    </ul>
                </li>
                <!-- <a href="CustomerProfile.html"><img class="profilePic" src="profileImg.png" alt="profileImg"></a> -->
            </nav>
        </header>

        <div class="container">
                    <h1>Shopping Cart</h1>
            <div class="shopping">
                <img src="bag.png">
                <span class="quantity">0</span>
            </div>
        <div class="list"></div>
    </div>

    <div class="card">
        <h1>Cart</h1>
        <ul class="listCard"></ul>
        <div class="checkOut">
            <a href="Payment.html"><div class="total">0</div></a>
            <div class="closeShopping">Close</div>
        </div>
    </div>

        <script>
            let openShopping = document.querySelector('.shopping');
            let closeShopping = document.querySelector('.closeShopping');
            let list = document.querySelector('.list');
            let listCard = document.querySelector('.listCard');
            let body = document.querySelector('body');
            let total = document.querySelector('.total');
            let quantity = document.querySelector('.quantity');

            openShopping.addEventListener('click', ()=>{
                body.classList.add('active');
            })
            closeShopping.addEventListener('click', ()=>{
                body.classList.remove('active');
            })

            let products = [
                {
                    id: 1,
                    name: 'CHEMISTRY BOOK',
                    image: 'product1.png',
                    price: 30
                },
                {
                    id: 2,
                    name: 'PHYSIC BOOK',
                    image: 'product2.png',
                    price: 35
                },
                {
                    id: 3,
                    name: 'LANYARD',
                    image: 'product3.png',
                    price: 10
                },
                {
                    id: 4,
                    name: 'ERASER',
                    image: 'product4.png',
                    price: 0.50
                },
                {
                    id: 5,
                    name: 'BLACK PEN',
                    image: 'product5.png',
                    price: 5
                },
                {
                    id: 6,
                    name: 'BLUE PEN',
                    image: 'product6.png',
                    price: 5
                }
            ];
            let listCards  = [];
            function initApp(){
                products.forEach((value, key) =>{
                    let newDiv = document.createElement('div');
                    newDiv.classList.add('item');
                    newDiv.innerHTML = `
                        <img src="${value.image}">
                        <div class="title">${value.name}</div>
                        <div class="price">${value.price.toLocaleString()}</div>
                        <button onclick="addToCard(${key})">Add To Cart</button>`;
                    list.appendChild(newDiv);
                })
            }
            initApp();
            function addToCard(key){
                if(listCards[key] == null){
                    listCards[key] = products[key];
                    listCards[key].quantity = 1;
                }
                reloadCard();
            }
            function reloadCard(){
                listCard.innerHTML = '';
                let count = 0;
                let totalPrice = 0;
                listCards.forEach((value, key)=>{
                    totalPrice = totalPrice + value.price;
                    count = count + value.quantity;
                    if(value != null){
                        let newDiv = document.createElement('li');
                        newDiv.innerHTML = `
                            <div><img src="${value.image}"/></div>
                            <div>${value.name}</div>
                            <div>${value.price.toLocaleString()}</div>
                            <div>
                                <button onclick="changeQuantity(${key}, ${value.quantity - 1})">-</button>
                                <div class="count">${value.quantity}</div>
                                <button onclick="changeQuantity(${key}, ${value.quantity + 1})">+</button>
                            </div>`;
                            listCard.appendChild(newDiv);
                    }
                })
                total.innerText = totalPrice.toLocaleString();
                quantity.innerText = count;
            }
            function changeQuantity(key, quantity){
                console.log(key, quantity);
                if(quantity == 0){
                    delete listCards[key];
                }else{
                    listCards[key].quantity = quantity;
                    listCards[key].price = quantity * products[key].price;
                }
                reloadCard();
            }
        </script>
    </body>
</html>
